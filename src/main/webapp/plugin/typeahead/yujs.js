if(typeof jQuery==="undefined"){throw new Error("yujs's JavaScript requires jQuery")}"object"!=typeof Yujs&&(Yujs={});"object"!=typeof Go&&(Go={});juicer.set({"tag::operationOpen":"{@","tag::operationClose":"}","tag::interpolateOpen":"%{","tag::interpolateClose":"}","tag::noneencodeOpen":"%%{","tag::noneencodeClose":"}","tag::commentOpen":"{#","tag::commentClose":"}"});+function(b){b.fn.entry=function(){var c=null;return b(this).each(function(){b(this).find("[data-widget]").each(function(){(c=b(this))[c.data().widget]()})})};var a=function(){};a.prototype.entry=b("body").entry;Yujs.Widget=a;Yujs.defaults={WE:"widget.initialize",WI:"widget.initializing",WD:"widget.initialized",WCE:"widget.cmd.process",WCI:"widget.cmd.processing",WCD:"widget.cmd.processed"};Go.conf=Go.conf||{};b("script[type='text/json']").each(function(e,c){var g=b(c),d=null;try{d=b.parseJSON(g.text())}catch(f){window.console&&window.console.warn("parse attribute "+g+" is faile.",f)}Go.conf[g.data("name")]=d||{}})}(jQuery);+function(a){var b=function(c){this.pageSize=c;this.offset=0};b.prototype.next=function(){this.offset++};b.prototype.getSize=function(e,d){var c=this.getSizeIndex(e);c=d?c+d:c;c=c<0?0:c;c=this.getSizeIndex(c);return this.pageSize[c]};b.prototype.getOffset=function(){if(this.offset==0){return 0}var e=this.getSize(this.offset),c=0;for(var d=0;d<=this.getSizeIndex(this.offset);d++){c+=this.pageSize[d]-e}return this.offset*e+c};b.prototype.getSizeIndex=function(c){return c>this.pageSize.length-1?this.pageSize.length-1:c};b.prototype.setOffset=function(c){this.offset=c};b.prototype.getOptions=function(){return{offset:this.getOffset(),size:this.getSize(this.offset)}};b.prototype.isDisabled=function(c){return c==null?false:this.getSize(this.offset)>c};Yujs.Pagination=b}(jQuery);+function(d){var e={swf:"http://cdn.staticfile.org/webuploader/0.1.0/Uploader.swf",server:"http://v0.api.upyun.com/goplay",hash:Go.conf.env[0]+"storage/upyun/hash.json"};function f(g){if(!window.WebUploader){return}this.$el=g;this.attrs=g.data();var i=this;g.find("[data-cmd='upload']").eq(0).click(function(){i.upload()});var h=this.uploader=WebUploader.create({swf:e.swf,server:e.server,pick:this.attrs.pick||"#pick",resize:false,accept:{title:"Images",extensions:"gif,jpg,jpeg,bmp,png",mimeTypes:"image/*"}});h.on("fileQueued",function(j){$list.append('<div id="'+j.id+'" class="item"><h4 class="info">'+j.name+'</h4><p class="state">等待上传...</p></div>')});h.on("uploadBeforeSend",function(l,k){var j=l.file;k.file=j.name;k.policy=hash[j.id]["policy"];k.signature=hash[j.id]["signature"]});h.on("uploadProgress",function(l,j){var m=d("#"+l.id),k=m.find(".progress .progress-bar");if(!k.length){k=d('<div class="progress progress-striped active"><div class="progress-bar" role="progressbar" style="width: 0%"></div></div>').appendTo(m).find(".progress-bar")}m.find("p.state").text("上传中");k.css("width",j*100+"%")});h.on("fileQueued",function(j){h.makeThumb(j,function(l,k){if(l){$list.text("预览错误")}else{$list.append('<img alt="" src="'+k+'" />')}})});h.on("uploadSuccess",function(j){d("#"+j.id).find("p.state").text("已上传")});h.on("uploadError",function(j){d("#"+j.id).find("p.state").text("上传出错")});h.on("uploadComplete",function(j){d("#"+j.id).find(".progress").fadeOut()})}f.prototype={upload:function(){var g=[],h=this.uploader,i=this;d.each(h.getFiles(),function(j,k){g.push({id:k.id,"content-type":k.type})});if(g.length==0){alert("请先选择需要上传的图片.");return}d.post(e.hash,{extKeyValues:this.attrs.extKeyValues||null,fileApiKeyValues:g},function(k,j,m,l){if(!k.msg){alert("上传组件初始化失败,请稍后重试.");return}i.hash=k.msg;h.upload()})},wating:function(){},progressing:function(){},preview:function(){},success:function(g){},error:function(g){},complete:function(g){}};function c(g){return g.data("widget")==="uploader"}f.VERSION="0.1.1";function b(g){return this.each(function(){var i=d(this);if(!c(i)){return}var h=i.data("yu.widget.uploader");if(!h){i.data("yu.widget.uploader",(h=new f(d(this))))}if(typeof g=="string"){h[g]()}})}var a=d.fn.uploader;d.fn.uploader=b;d.fn.uploader.Constructor=f;d.fn.uploader.noConflict=function(){d.fn.uploader=a;return this}}(jQuery);+function(c){var i={"default":['<div class="modal fade">','<div class="modal-dialog %%{clazz}">','<div class="modal-content">','<div class="modal-header">','<button type="button" class="close" data-dismiss="modal">','<span aria-hidden="true">&times;</span>','<span class="sr-only">Close</span>',"</button>",'<h4 class="modal-title">%%{title}</h4>',"</div>",'<div class="modal-body">',"%%{body}","</div>","</div>","</div>","</div>"]};var f=function(j){this.instance=d(j.data().type||"modal",j)};f.prototype.open=function(){this.instance.$el.trigger("dialog.open");this.instance.open();this.instance.$el.trigger("dialog.opened")};f.prototype.close=function(){this.instance.$el.trigger("dialog.close");this.instance.close();this.instance.$el.trigger("dialog.closed")};f.prototype.isClosed=function(){return this.instance.isClosed()};function d(k,j){if("modal"===k){return new g(j)}else{if("popover"===k){return new b(j)}}return{}}function b(j){if(!c.isFunction(c.fn.popover)){return}this.$el=j;this.attrs=j.data();this.$open=j.children('[data-cmd="open"]');var k=this;this.$open.popover({title:this.attrs.title||null,html:true,container:j.children("[dialog-wrapper]"),trigger:"manual",template:'<div class="popover" role="tooltip"><button type="button" class="close" data-dismiss="modal" style="padding: 3px;"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:function(){k.$el.children("[dialog-wrapper]").empty();var l=k.generateNode();k.$el.on("click","button.close",function(){k.close()});k.$node=l;l.entry();return l}});j.children('[data-cmd="open"]').on("dialog.popover.open click",this,function(l){l.data.open()});c.each(["shown.bs.popover","show.bs.popover","hide.bs.popover","hidden.bs.popover"],function(l,m){j.on(m,{_this:k,e:(m.split(".")[0])},function(n){j.trigger("dialog.popover."+n.data.e,n.data._this.$node)})})}b.prototype.open=function(){this.$open.popover("show")};b.prototype.close=function(){this.$open.popover("hide")};b.prototype.generateNode=function(){return c(c(this.attrs.targetTemplate).html().trim())};function g(j){if(!(c.isFunction(c.fn.modal)&&c.isFunction(juicer))){return}this.$el=j;this.attrs=j.data();if(this.attrs.targetCmd){c(document).on("dialog.modal.open click",this.attrs.targetCmd,this,function(k){k.data.open()})}else{j.on("dialog.modal.open click",">[data-cmd='open']",this,function(k){k.data.open()})}}g.prototype.open=function(){c("[data-widget='dialog']").dialog("close");this.attrs.isClosed=false;var j=i["default"].join("").trim(),k=this.generateNode(j);k.entry();k.modal(this.attrs);k.modal("show")};g.prototype.isClosed=function(){return this.attrs.isClosed};g.prototype.close=function(){this.attrs.isClosed=true;(this.node||c()).modal("hide")};g.prototype.generateNode=function(k){var j=c(this.attrs.targetTemplate).html().trim();var l=c(juicer(k,{title:this.attrs.title,body:j,clazz:this.attrs["class"]||""}));this.$el.children("[dialog-wrapper]").empty().append(l);this.node=l;return l};function e(j){return j.data("widget")==="dialog"}f.VERSION="0.1.1";function h(j,k){var m,l;m=this.each(function(){var o=c(this);if(!e(o)){return}var n=o.data("yu.widget.dialog");if(!n){o.data("yu.widget.dialog",(n=new f(c(this))))}if(typeof j=="string"){(l=n[j]())}});return k?l:m}var a=c.fn.dialog;c.fn.dialog=h;c.fn.dialog.Constructor=f;c.fn.dialog.noConflict=function(){c.fn.dialog=a;return this}}(jQuery);+function(f){var b=function(g){this.$e=g;this.attrs=g.data();this.ajax=null;if(this.attrs.listenTo){this.listenTo()}if(this.attrs.distributeUrl){this.distribute()}};b.prototype.distribute=function(){var g=this;this.getAjax()["get"](this.attrs.distributeUrl,null,{success:function(i,j,h){g.$e.trigger("distributor.distributed",i&&i.successful?i.msg:null)}})};b.prototype.listenTo=function(){f(this.attrs.listenTo).on("distributor.distribute",this,function(g){}).on("distributor.distributed",this,function(g,h){if(c[g.data.attrs.cmd]){c[g.data.attrs.cmd](g.data.$e,h)}else{c.auto(g.data.attrs.cmd,g.data.$e,h)}})};b.prototype.getAjax=function(){return this.ajax||(this.ajax=new Yujs.Ajax())};b.VERSION="0.1.1";var c={replace:function(g,i){if(!g){return}var h=null;if(g.data().name){h=i[g.data().name]}else{h=i}g&&g.empty().append(h)},auto:function(g,h,i){Go[g]&&Go[g](h,i)}};function e(g){return g.data("widget")==="distributor"}function d(g){return this.each(function(){var i=f(this);if(!e(i)){return}var h=i.data("yu.widget.distributor");if(!h){i.data("yu.widget.distributor",(h=new b(f(this))))}if(typeof g=="string"){h[g]()}})}var a=f.fn.distributor;f.fn.distributor=d;f.fn.distributor.Constructor=b;f.fn.distributor.noConflict=function(){f.fn.distributor=a;return this}}(jQuery);+function(e){var a=function(f){if(!e.isFunction(e.fn.inputlimiter)){return}this.$el=f;this.attrs=f.data();e(this.attrs.targetField).inputlimiter(e.extend({remText:"还可以输入%n个字符.",limitText:"",remTextHideOnBlur:false,boxSelector:f,boxAttach:false,remFullText:null},this.attrs));e(this.attrs.targetField).keyup()};a.VERSION="0.1.1";function d(f){return f.data("widget")==="charinputlimiter"}function c(f){return this.each(function(){var h=e(this);if(!d(h)){return}var g=h.data("yu.widget.charinputlimiter");if(!g){h.data("yu.widget.charinputlimiter",(g=new a(e(this))))}if(typeof f=="string"){g[f]()}})}var b=e.fn.charinputlimiter;e.fn.charinputlimiter=c;e.fn.charinputlimiter.Constructor=a;e.fn.charinputlimiter.noConflict=function(){e.fn.charinputlimiter=b;return this}}(jQuery);+function(e){var b=function(g){this.$el=g;this.attrs=g.data();this.ajax=new Yujs.Ajax();this.pagination=new Yujs.Pagination(this.attrs.pageSize);this.page=null;var f=null;e(this.ajax).bind("ajax.reset",function(i){f.button("reset")});e(this.ajax).bind("ajax.start",function(i){f.button("loading")});var h=this;g.children("[data-cmd='next']").on("fetcher.next click",this,function(i){f=e(i.target);h.next()});g.find("[data-cmd='search']").on("fetcher.search click",this,function(i){f=e(i.target);h.search()});if(!this.isLazy()){if(g.find("[data-cmd='search']").length==0){f=g.children("[data-cmd='next']");this.fetch()}else{g.find("[data-cmd='search']").trigger("fetcher.search")}}};b.VERSION="0.1.1";b.prototype.fetch=function(){var g=this;if(this.attrs.disabled){this.disable();return}var f=e.extend(g.getFormData(),this.pagination.getOptions());this.attrs.fetchUrl&&this.ajax.get(this.attrs.fetchUrl,f,{success:function(i,j,h){if(i.successful){g.setPage(i.page);g.wrap(i.msg)}},error:function(h,j,i){},complete:function(){g.$el.trigger(Yujs.defaults.WCD);if(g.isDisabled()){g.disable()}else{g.show()}}})};b.prototype.search=function(){this.$el.find("[fetcher-wrapper]").empty();this.pagination=new Yujs.Pagination(this.attrs.pageSize);this.fetch()};b.prototype.isLazy=function(){return this.attrs.model==="lazy"};b.prototype.setPage=function(f){if(!f){return}this.page=f};b.prototype.disable=function(){this.$el.children('[data-cmd="next"]').hide()};b.prototype.show=function(){this.$el.children('[data-cmd="next"]').show()};b.prototype.next=function(){if(this.isDisabled()){return}this.pagination.next();this.fetch()};b.prototype.isDisabled=function(){return this.attrs.disabled||this.pagination.isDisabled(this.page&&this.page.count)};b.prototype.wrap=function(h){var f=null;try{f=e(h.trim())}catch(g){f=e("<div>"+h.trim()+"</div>")}f.entry();this.$el.find("[fetcher-wrapper]").append(f)};b.prototype.getFormData=function(){var g={},h=[],f;(f=e.merge(this.$el,this.attrs.relationship?e(this.attrs.relationship):[])).find("[name]").each(function(i,j){h.push(e(j).attr("name"))});e.each(_.unique(h),function(k,j){g[j]=f.find("[name='"+j+"']").value()});return g};function d(f){return f.data("widget")==="fetcher"}function c(f){return this.each(function(){var h=e(this);if(!d(h)){return}var g=h.data("yu.widget.fetcher");if(!g){h.data("yu.widget.fetcher",(g=new b(e(this))))}if(typeof f=="string"){g[f]()}})}var a=e.fn.fetcher;e.fn.fetcher=c;e.fn.fetcher.Constructor=b;e.fn.fetcher.noConflict=function(){e.fn.fetcher=a;return this}}(jQuery);+function(f){var c=function(g){this.$el=g;this.attrs=g.data();this.none();f(this.attrs.targetForm).bind(Yujs.defaults.WCD,this,function(h){h.data.fetch()});g.children("[data-cmd='fetch']").click(this,function(h){h.data.fetch()});this.fetch()};c.prototype.display=function(){this.clear();this.$el.show().children("a.cpatcha-image").append(this.image)};c.prototype.none=function(){this.$el.hide();this.clear()};c.prototype.clear=function(){this.$el.children("a.cpatcha-image").empty();this.$el.children("input[name='captcha']").val("")};c.prototype.newImage=function(){var g=new Image();f(g).click(this,function(h){h.data.fetch()}).error(this,function(h){h.data.none()}).load(this,function(h){h.data.display()});this.image=g};c.prototype.fetch=function(){this.newImage();this.clear();var g=b();if(null==g){window.console&&window.console.warn("fetch captcha is faile, the fetch location is null.");return}var h=this;setTimeout(function(){h.image.src=g},200)};c.prototype.error=function(){};function b(){var g=null;return(g=Go.conf.env[0])&&(g+"captcha.gif?"+Math.random())}c.VERSION="0.1.1";function e(g){return g.data("widget")==="captcha"}function d(g){return this.each(function(){var i=f(this);if(!e(i)){return}var h=i.data("yu.widget.captcha");if(!h){i.data("yu.widget.captcha",(h=new c(f(this))))}if(typeof g=="string"){h[g]()}})}var a=f.fn.captcha;f.fn.captcha=d;f.fn.captcha.Constructor=c;f.fn.captcha.noConflict=function(){f.fn.captcha=a;return this}}(jQuery);+function(e){var b=function(g){this.$el=g;this.attrs=g.data();this.ajax=new Yujs.Ajax();var f=null;e(this.ajax).bind("ajax.reset",function(){f.button("reset")});e(this.ajax).bind("ajax.start",this,function(h){h.data.error(true);f.button("loading")});this.$el[0].tabIndex=-1;g.on("form.submit click","[data-cmd='submit']",function(){f=e(this);g.form("submit")});if(this.attrs.enter!==false){g.on("keyup","input,select,textarea",function(h){if(h.which==13){f=e(h.delegateTarget).find(">[data-cmd='submit']");g.form("submit")}})}};b.VERSION="0.1.1";b.prototype.submit=function(){var f=this;this.ajax[f.attrs.method](f.attrs.action,f.getFormData(),{success:function(h,i,g){if(!(h.errcode==null||h.errcode==0)){f.error(h.msg);f.$el.trigger("form.submit.error",h)}else{f.refresh(h.msg);f.$el.trigger("form.submit.success",h)}},error:function(g,i,h){f.$el.trigger("form.submit.error")},complete:function(){f.$el.trigger(Yujs.defaults.WCD)}})};b.prototype.getFormData=function(){var g={},h=[],f;(f=e.merge(this.$el,this.attrs.relationship?e(this.attrs.relationship):[])).find("[name]").each(function(i,j){h.push(e(j).attr("name"))});e.each(_.unique(h),function(k,j){g[j]=f.find("[name='"+j+"']").value()});return g};b.prototype.refresh=function(f){this.$el[0].focus();if(this.attrs.refresh){this.$el.empty().html(f);this.$el.entry()}};b.prototype.error=function(f){if(f===true){this.$el.find("[errtip]").empty().hide();return}if(typeof f==="string"){this.$el.find("[errtip='']").show().html(f)}else{for(var g in f){this.$el.find("[errtip='"+g+"']").show().html(f[g])}}};function d(f){return f.data("widget")==="form"}function c(f){return this.each(function(){var h=e(this);if(!d(h)){return}var g=h.data("yu.widget.form");if(!g){h.data("yu.widget.form",(g=new b(e(this))))}if(typeof f=="string"){g[f]()}})}var a=e.fn.form;e.fn.form=c;e.fn.form.Constructor=b;e.fn.form.noConflict=function(){e.fn.form=a;return this}}(jQuery);+function(d){var g=function(h){if(!d.isFunction(d.fn.datetimepicker)){return}var j=this;this.attrs=h.data();this.$el=h;var i=h.prop("readonly","readonly").datetimepicker({minDate:e(),maxDate:f(),format:"YYYY-MM-DD HH:mm:ss",locale:"zh-cn",stepping:30}).on("dp.change",function(k){})};function e(){return new Date()}function f(h){return new Date(""+(e().getFullYear()+2))}function c(h){return h.data("widget")==="calendar"}function b(h){return this.each(function(){var j=d(this);if(!c(j)){return}var i=j.data("yu.widget.calendar");if(!i){j.data("yu.widget.calendar",(i=new g(d(this))))}if(typeof h=="string"){i[h]()}})}var a=d.fn.calendar;d.fn.calendar=b;d.fn.calendar.Constructor=g;d.fn.calendar.noConflict=function(){d.fn.calendar=a;return this}}(jQuery);+function(e){var d=function(g){if(!e.isFunction(e.fn.typeahead)){return}this.attrs=g.data();var h=this;g.typeahead(e.extend({minLength:1,highlight:true,source:function(j,i){i(f(j,h.attrs.suggestions))}},this.attrs))};function f(l,g){var h=[],j,i,k;k=((i=l.indexOf("@"))>-1?".*@"+l.substring(i+1):"")+".*";j=new RegExp(k,"i");e.each(g,function(m,n){if(j.test(n)){h.push((i>-1?l.substring(0,i):l)+n)}});return h}function c(g){return g.data("widget")==="autocomplete"}function b(g){return this.each(function(){var i=e(this);if(!c(i)){return}var h=i.data("yu.widget.autocomplete");if(!h){i.data("yu.widget.autocomplete",(h=new d(e(this))))}if(typeof g=="string"){h[g]()}})}var a=e.fn.autocomplete;e.fn.autocomplete=b;e.fn.autocomplete.Constructor=d;e.fn.autocomplete.noConflict=function(){e.fn.autocomplete=a;return this}}(jQuery);+function(b){var a=function(){this.isCompleted=true;this.time=null};a.VERSION="0.1.1";a.prototype.request=function(g,d,e,c){if(!this.isCompleted){return}b(this).trigger("ajax.start");var f=this;b.ajax({url:d,cache:false,data:b.serializeFormData(e),type:g,context:f,headers:{"X-Requested-With":"XMLHttpRequest"},beforeSend:function(h){f.isCompleted=false},success:function(i,j,h){i=_.isUndefined(i.responseObject)?i:i.responseObject;c.success(i,j,h)},error:c.error,complete:function(h,i){f.complete();c.complete&&c.complete(h,i)}});this.time=setTimeout(function(){f.complete()},1000*10)};a.prototype.complete=function(){clearTimeout(this.time);this.isCompleted=true;b(this).trigger("ajax.reset")};b.each(["get","post","put","delete"],function(d,c){a.prototype[c]=function(f,g,e){this.request(c,f,g,e)}});Yujs.Ajax=a}(jQuery);+function(a){a.fn.location=function(){var b={};a.each(window.location.search.split(/\?|\&/),function(c,d){if(!d){return}var e=d.split("=");b[e[0]]=decodeURI(e[1])});return b};a.fn.value=function(){var e=[],g,d,h,c,f=a(this),b=f.length>1;f.each(function(j,k){c=a(k);h=f.prop("nodeName").toLowerCase();if(a.inArray(h,["input","textarea","select"])>-1){(d=c.attr("type"))&&(d=d.toLowerCase());if(a.inArray(d,["radio","checkbox"])>-1){g=c.filter(":checked").val();if(d=="radio"){b=false}}else{g=c.val()}}else{g=c.text()}g&&e.push(g)});return(b?e:e[0])||null};a.serializeFormData=function(c){if(!c||"object"!=typeof c){return c}var b={};a.each(c,function(d,e){if(e&&e instanceof Array){a.each(e,function(g,f){b[d+"["+g+"]"]=a.serializeFormData(f)})}else{b[d]=a.serializeFormData(e)}});return b}}(jQuery);